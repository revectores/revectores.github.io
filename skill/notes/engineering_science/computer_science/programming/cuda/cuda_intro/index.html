<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title> CUDA Introduction
 </title>
  <link rel="stylesheet" type="text/css" href="http://revectores.com/static/css/newsprint.css"> 
  <link rel="stylesheet" type="text/css" href="http://revectores.com/static/css/blog.css"> 
  <link rel="stylesheet" type="text/css" href="http://revectores.com/static/css/code.css"> 
</head>
<body>

<p><a href="../"><< cuda</a></p>

<h1 id="cuda-introduction">CUDA Introduction</h1>
<p><strong>CUDA(Compute Unified Device Architecture)</strong> is a parallel computing platform and application programming interface model created by <a href="">Nvidia</a>.</p>
<p>Host: The CPU and its memory (host memory)</p>
<p>Device: The GPU and its memory (device memory).</p>
<p>GPU connected to PCI-e, hence GPU also connects to the host memory. On the contrary, CPU cannot read device memory normally. Copy action can be executed between host memory and device memory in both directions, which can usually be the bottleneck of GPU computation.</p>
<p>A computer with both CPU and GPU is considered <strong>heterogeneous</strong>.</p>
<p>Basic <code>Hello, world</code> program with device code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>__device__ <span class="dt">void</span> device_func(<span class="dt">void</span>){}</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>__global__ <span class="dt">void</span> kernel_func(<span class="dt">void</span>){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>    device_func();</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>    kernel_func&lt;&lt;&lt;<span class="dv">1</span>,<span class="dv">1</span>&gt;&gt;&gt;();</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>    printf();</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>}</span></code></pre></div>
<p><code>__global__</code> keyword indicates the function is running on the device but invoked in the kernel. <code>__device__</code> indicates the function is running on the device and invoked in the device.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>__global__ <span class="dt">void</span> add(<span class="dt">int</span> *a, <span class="dt">int</span> *b, <span class="dt">int</span> *c){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>    *c = *a + *b;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note the the parameter pointers should be</p>
<p><code>cudaMalloc()</code>, <code>cudaFree()</code>, <code>cudaMemcpy()</code> functions are provided for memory management.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>cudaMemcpy(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>    <span class="dt">void</span>*       dst,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>    <span class="dt">const</span> <span class="dt">void</span>* src,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>    <span class="dt">size_t</span>      count,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>    <span class="kw">enum</span>        type,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>);</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>    <span class="dt">int</span> a, b, c;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>    </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>}</span></code></pre></div>


</body>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</html>