<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title> Interpolation
 </title>
  
  <link rel="stylesheet" type="text/css" href="http://revectores.com//static/css/newsprint.css"> 
  <link rel="stylesheet" type="text/css" href="http://revectores.com//static/css/blog.css"> 
  <link rel="stylesheet" type="text/css" href="http://revectores.com//static/css/code.css"> 
  
</head>
<body>

<p><a href="../"><< numerical_analysis</a></p>

<h1 id="interpolation">Interpolation</h1>
<p>For the continous function <span class="math inline">\(f(x)\)</span> defined in <span class="math inline">\([a,b]\)</span>, points <span class="math inline">\(x_0, x_1, \ldots , x_n\)</span> are <span class="math inline">\(n+1\)</span> different points in <span class="math inline">\([a,b]\)</span>, <span class="math inline">\(\varPhi\)</span> is some function class, if <span class="math inline">\(\phi(x)\in\varPhi\)</span> meets <span class="math display">\[
\phi(x_i) = f(x_i), ~~~~i=0,1,\ldots, n
\]</span> we say <span class="math inline">\(\phi(x)\)</span> is the <strong>interpolation function</strong> of <span class="math inline">\(f(x)\)</span> in <span class="math inline">\(\varPhi\)</span> about <span class="math inline">\(x_0, x_1, \ldots, x_n\)</span>.</p>
<p>Polynomial function is smooth infinitely, the derivative and integral are easy to compute, hence we usually use the polynomial as the interpolation function.</p>
<h3 id="lagrange-interpolation">1. Lagrange Interpolation</h3>
<p><span class="math display">\[
\left\{\begin{array}{ll}
a_0 + a_1x_0 + a_2x_0^2 + \cdots + a_nx_0^n = f(x_0) &amp; \\
a_0 + a_1x_1 + a_2x_1^2 + \cdots + a_nx_1^n = f(x_1) &amp; \\
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\cdots \\
a_0 + a_1x_n + a_2x_n^2 + \cdots + a_nx_n^n = f(x_n)
\end{array}\right.
\]</span> The coefficient determinant <span class="math display">\[
V(x_0, x_1, \ldots, x_n) =
\begin{vmatrix}
1 &amp; x_0 &amp; x_0^2 &amp; \cdots &amp; x_0^n \\
1 &amp; x_1 &amp; x_1^2 &amp; \cdots &amp; x_1^n \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_n &amp; x_n^2 &amp; \cdots &amp; x_n^n \\
\end{vmatrix}
= \prod_{0\le k\le i\le n}(x_i - x_j)
\]</span> For different <span class="math inline">\(x_i, 0\le i\le n\)</span>, the value of determinant <span class="math inline">\(\prod_{0\le k\le i\le n}(x_i - x_j) \neq 0\)</span>, hence there’s one and only one solution. <span class="math display">\[
l_i(x)
= \prod_{j=0\\j\neq i}^n \frac{x-x_j}{x_i-x_j}
= \frac{(x-x_0)\cdots(x-x_{i-1})(x-x_{i+1})\cdots(x-x_n)}{(x_i-x_0)\cdots(x_i-x_{i-1})(x_i-x_{i+1})\cdots(x_i-x_n)}
\]</span></p>
<p><span class="math display">\[
L_n(x)
= \sum_{i=0}^n l_i(x)f(x_i)
= \sum_{i=0}^n \prod_{j=0\\j\neq i}^n \frac{x-x_j}{x_i-x_j}f(x_i)
\]</span> The base function are orthogonal, <span class="math display">\[
l_i(x_j) = \delta_{ij} =
\left\{\begin{array}{ll}
1,&amp; i=j &amp; \\
0,&amp; i\neq j&amp;
\end{array}\right.
\]</span></p>
<p>For the linear Lagrange interpolation, <span class="math display">\[
R(x) = f(x) - L_1(x) = \frac{f&#39;&#39;(\xi)}{2!}(x-x_0)(x-x_1), ~~~~ \xi\in[a,b]
\]</span></p>
<blockquote>
<p><strong>Proof.</strong> For <span class="math inline">\(R(x) = f(x) - L_1(x)\)</span>, since <span class="math inline">\(f(x_0) = L_1(x_0), f(x_1) = L_1(x_1)\)</span>, we have <span class="math inline">\(R(x_0) = R(x_1) = 0\)</span>. Let <span class="math display">\[
R(x) = k(x)(x-x_0)(x-x_1)
\]</span> Construct the difference <span class="math display">\[
\Psi(t) = f(t) - L_1(t) - k(x)(t-x_0)(t-x_1)
\]</span> we have <span class="math inline">\(\Psi(x_0) = \Psi(x_1) = \Phi(x) = 0\)</span>, without loss of generality, assume <span class="math inline">\(x_0&lt;x&lt;x_1\)</span>, applying Rolle’s theorem in section <span class="math inline">\([x_0, x]\)</span> and <span class="math inline">\([x, x_1]\)</span>, we have <span class="math inline">\(\Psi(\xi_1) = \Psi(\xi_2) = 0\)</span>, where <span class="math inline">\(\xi_1\in[x_0, x], \xi_2\in[x, x_1]\)</span>. Applying Rolle’s theorem to <span class="math inline">\(\Psi&#39;(t)\)</span> in section <span class="math inline">\([\xi_1, \xi_2]\)</span>, we have <span class="math inline">\(\Psi&#39;&#39;(\xi)=0\)</span>, where <span class="math inline">\(\xi\in[\xi_1,\xi_2]\)</span>.</p>
<p>Substitute <span class="math inline">\(t\)</span> with <span class="math inline">\(\xi\)</span>, <span class="math display">\[
\begin{align}
f&#39;&#39;(t) - 2!k(x) &amp;= \Psi&#39;&#39;(t) \\
f&#39;&#39;(t) - 2!k(x) &amp;= 0 \\
k(x) &amp;= \frac{f&#39;&#39;(\xi)}{2!}
\end{align}
\]</span> That is, <span class="math display">\[
R(x) = f(x) - L_1(x) = \frac{f&#39;&#39;(\xi)}{2!}(x-x_0)(x-x_1)
\]</span></p>
</blockquote>
<p>For the quadratic Lagrange interpolation, <span class="math display">\[
R(x) = f(x) - L_1(x) = \frac{f^{(3)}(\xi)}{3!}(x-x_0)(x-x_1)(x-x_2),~~~~ \xi\in[a,b]
\]</span> Generally, <span class="math display">\[
R_n(x) = f(x) - L_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}\prod_{i=0}^n(x-x_i),~~~~\xi\in[a, b]
\]</span></p>
<blockquote>
<p><span class="math display">\[
\begin{align}
|R(x)|
&amp;= \left| \frac{f&#39;&#39;(\xi)}{2!}(x-x_{i-1})(x-x_i) \right| \\
&amp;= \left| \frac{\sin(\xi)}{2}(x-x_{i-1})(x-x_i) \right| \\
&amp;\le \frac{1}{2} |(x-x_{i-1})(x-x_i)| \\
&amp;\le \frac{1}{2} \left|\left( \frac{x_{i-1}+x_i}{2}-x_{i-1}\right) \left( \frac{x_{i-1}+x_i}{2}-x_i\right) \right| \\
&amp;= \frac{1}{8}|(x_{i-1}-x_i)(x_i-x_{i-1})| \\
&amp;= \frac{h^2}{8} \le \frac{1}{2}\times 10^{-4}
\end{align}
\]</span> Hence <span class="math inline">\(h\le 0.02\)</span></p>
</blockquote>
<h3 id="newtons-interpolation">2. Newton’s Interpolation</h3>
<h5 id="difference-quotient"># Difference Quotient</h5>
<p>Define the <span class="math inline">\(k\)</span>-th difference quotient as <span class="math display">\[
f[x_0, x_1, \ldots, x_k] = \frac{f[x_1, x_2, \ldots, x_k] - f[x_0, x_1, \ldots, x_{k-1}]}{x_k - x_0}
\]</span> Specially, the 1st, 2nd and 3rd difference quotients are <span class="math display">\[
f[x_0] = f(x_0)
\]</span></p>
<p><span class="math display">\[
f[x_0, x_1] = \frac{f(x_1)-f(x_0)}{x_1-x_0}
\]</span></p>
<p><span class="math display">\[
f[x_0, x_1, x_2] = \frac{f[x_1, x_2] - f[x_0, x_1]}{x_2 - x_0}
\]</span></p>
<h5 id="property-of-difference-quotient"># Property of Difference Quotient</h5>
<p>Property 1. The <span class="math inline">\(k-\)</span>th difference quotient is the linear combination of function value <span class="math inline">\(f(x_0), f(x_1), \ldots, f(x_k)\)</span>. <span class="math display">\[
f[x_0, x_1, \ldots, x_k] = \sum_{i=0}^k \frac{1}{(x_i-x_0)\cdots(x_i-x_{i-1})(x_i-x_i)\cdots(x_i-x_k)}f(x_i)
\]</span> Property 2. For any permutations <span class="math inline">\(i_0, i_1, \ldots, i_k\)</span> of <span class="math inline">\(0,1,\ldots, k\)</span>, we have <span class="math display">\[
f[x_0, x_1, \ldots, x_k] = f[x_{i_0}, x_{i_1}, \ldots, x_{i_k}]
\]</span> Property 3. If <span class="math inline">\(f(x)\)</span> has the <span class="math inline">\((n-1)\)</span>-th continous derivative and <span class="math inline">\(f^{(n)}(x)\)</span> exists, <span class="math display">\[
f[x_0, x_1, \ldots, x_k] = \frac{f^{(n)}(\xi)}{n!}
\]</span></p>
<blockquote>
<p>Example. Compute <span class="math inline">\(f[1,2,3,4]\)</span> and <span class="math inline">\(f[1,2,3,4,5]\)</span> for the function <span class="math inline">\(f(x) = 10x^3 - 100x + 1\)</span>. <span class="math display">\[
f[x_0, x_1, x_2, x_3] = \frac{f^{(3)}(\xi)}{3!} = 10 \\
f[x_0, x_1, x_2, x_3, x_4] = \frac{f^{(4)}(\xi)}{4!} = 0
\]</span></p>
</blockquote>
<p>Difference quotient table:</p>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 16%" />
<col style="width: 25%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_i)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f[x_{i-1}, x_i]\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f[x_{i-2}, x_{i-1}, x_i]\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f[x_{i-3}, x_{i-2}, x_{i-1}, x_i]\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(x_0)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(x_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(x_1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_0, x_1]\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(x_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(x_2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_1, x_2]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_0, x_1, x_2]\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(x_3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(x_3)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_2, x_3]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_1, x_2, x_3]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_0, x_1, x_2, x_3]\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_n\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_{n-1}, x_n]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_{n-2}, x_{n-1}, x_n]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[x_{n-3}, x_{n-2}, x_{n-1}, x_n]\)</span></td>
</tr>
</tbody>
</table>
<h5 id="newtons-interpolation-1"># Newton’s Interpolation</h5>
<p>The <span class="math inline">\(n\)</span>-th newton’s interpolation. <span class="math display">\[
\begin{align}
N_n(x) =
&amp; f(x_0) + \sum_{k=1}^n f[x_0, x_1, \ldots, x_k]\prod_{i=0}^{k-1}(x-x_i)
\\
=&amp; f[x_0] + f[x_0, x_1](x-x_0) + f[x_0, x_1, x_2](x-x_0)(x-x_1) + \cdots \\
&amp;+ f[x_0, x_1, \ldots , x_n](x-x_0)(x-x_1)\cdots(x-x_{n-1})
\end{align}
\]</span> Reminder term <span class="math display">\[
R_n(x) = (x-x_0)(x-x_1)\cdots(x-x_n)f[x, x_0, x_1, \ldots, x_n]
\]</span></p>
<h3 id="hermite-interpolation">3. Hermite Interpolation</h3>
<p>If the interpolation requires not only the the function value itself but also its derivatives (for some points and orders), it’s called <strong>Hermite interpolation</strong>. <span class="math display">\[
\begin{align}
H_3(x) =&amp; \left( 1 + 2\frac{x-x_0}{x_1-x_0} \right)\left( \frac{x - x_1}{x_0 - x_1} \right)^2 y_0 + \left( 1 + 2\frac{x-x_1}{x_0-x_1} \right)\left( \frac{x - x_0}{x_1 - x_0} \right)^2 y_1
\\
&amp;+ (x-x_0)\left(\frac{x-x_1}{x_0-x_1}\right)m_0 + (x-x_1)\left( \frac{x-x_0}{x_1-x_0} \right)m_1
\end{align}
\]</span></p>
<p>For the given <span class="math inline">\((x_i, f(x_i), f&#39;(x_i)), i = 0, 1, \ldots, n\)</span>, define the sequence <span class="math display">\[
z_0 = x_0, z_1 = x_0, z_2 = x_1, z_3 = x_1
\]</span></p>
<p><span class="math display">\[
H_{2n+1}(x) = f[x_0] + \sum_{k=1}^{2n+1}f[z_0, z_1, \ldots, z_k](x-z_0)\cdots(x-z_{k-1})
\]</span></p>
<blockquote>
<p>Example. Given <span class="math inline">\(f(x_0), f(x_1), f(x_0)\)</span>, construct quadratic interpolation polynomial <span class="math inline">\(H(x)\)</span>.</p>
</blockquote>
<table>
<colgroup>
<col style="width: 3%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 25%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(z_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(z_i)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f[z_{i-1}, z_i]\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f[z_{i-2}, z_{i-1}, z_i]\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;"><span class="math inline">\(z_0=x_0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(z_0)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(z_1=x_0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(z_1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[z_0, z_1] = f&#39;(x_0)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(z_2=x_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f(z_2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[z_1, z_2] = f[x_0, x_1]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f[z_0, z_1, z_2] = \dfrac{f[x_0, x_1] - f&#39;(x_0)}{x_1 - x_0}\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\begin{align}
&amp; H(x) = f(x_0) + (x-x_0)f&#39;(x_0) + \frac{f[x_0, x_1] - f&#39;(x_0)}{x_1-x_0}(x-x_0)^2 \\
&amp; R(x) = \frac{f&#39;&#39;&#39;(\xi)}{3!}(x-x_0)^2(x-x_1), ~~~~\xi\in[x_0, x_1]
\end{align}
\]</span></p>
<h3 id="subsection-interpolation">4. Subsection Interpolation</h3>
<h3 id="cubic-spline-function">5. Cubic Spline Function</h3>
<p>Given the <span class="math inline">\(n+1\)</span> points <span class="math display">\[
f(x_i) = y_i, 0\le i\le n
\]</span> Construct cubic polynomial <span class="math display">\[
S(x) = a_ix^3 + b_ix^2 + c_ix + d_i,~ i= 0, 1,\ldots, n-1
\]</span></p>
<p>and we enforce the zero, first, and second derivatives of adjacent interval continuous: <span class="math display">\[
\left\{\begin{array}{ll}
S_{i-1}(x_i) = S_i(x_i)  \\
S&#39;_{i-1}(x_i) = S&#39;_i(x_i)  \\
S&#39;&#39;_{i-1}(x_i) = S&#39;&#39;_i(x_i)
\end{array}\right.
\]</span></p>
<h5 id="m-relation"># M Relation</h5>
<p>Denote <span class="math inline">\(M_i = f&#39;&#39;()\)</span> <span class="math display">\[
S&#39;&#39;(x) =
\]</span></p>
<p>Finally we have <span class="math display">\[
\mu_i M_{i-1} + 2M_i + \lambda_i M_{i+1} = d_i, ~~i=1,2,\ldots, n-1
\]</span> where <span class="math display">\[
\left\{\begin{array}{ll}
h_i = x_{i+1} - x_i \\
\lambda = \dfrac{h_i}{h_i + h_{i-1}} \\
\mu_i = 1 - \lambda_i \\
d_i = 6y[x_{i-1}, x_i, x_{i+1}]
\end{array}\right.
\]</span></p>
<blockquote>
<p>Example. Given the points</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(x\)</span></th>
<th style="text-align: center;">1.1</th>
<th style="text-align: center;">1.2</th>
<th style="text-align: center;">1.4</th>
<th style="text-align: center;">1.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(f(x)\)</span></td>
<td style="text-align: center;">0.4000</td>
<td style="text-align: center;">0.8000</td>
<td style="text-align: center;">1.6500</td>
<td style="text-align: center;">1.8000</td>
</tr>
</tbody>
</table>
<p>Let <span class="math inline">\(M_0=M3\)</span>, construct the <span class="math inline">\(M\)</span> Relationship of cubic spline function and compute <span class="math inline">\(f(1.25)\)</span>. <span class="math display">\[
\begin{align}
&amp; h_0 = x_1 - x_0 =  \\
&amp; h_1 = x_2 - x_1 =  \\
&amp; h_2 = x_3 - x_2 =  \\
&amp; \lambda_1 = \frac{h_1}{h_1+h_0} = \\ 
&amp; \lambda_2 = \frac{h_2}{h_2+h_1} = \\
&amp; \mu_1 = 1-\lambda_1 \\
&amp; d_1 =  \\
&amp; d_2 =  \\
\end{align}
\]</span></p>
<p>Since <span class="math inline">\(M_0 = M_3\)</span> <span class="math display">\[
\begin{bmatrix}
2 &amp; 0.6667 \\
0.6667 &amp; 2
\end{bmatrix}
\begin{bmatrix}
M1 \\
M2
\end{bmatrix}
=
\begin{bmatrix}
5 \\
-55
\end{bmatrix}
\]</span></p>
<p>The solution <span class="math inline">\(M_1=13.125, M_2=-31.875\)</span>,</p>
<p><span class="math display">\[
S(x) =
\]</span></p>
</blockquote>
<p>Advantage: The second derivatives are continuous, and human cannot notice the discontinuity of third level derivative.</p>


</body>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</html>