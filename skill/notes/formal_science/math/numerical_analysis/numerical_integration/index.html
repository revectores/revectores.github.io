<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title> Numerical Integration
 </title>
  
  <link rel="stylesheet" type="text/css" href="http://revectores.com//static/css/newsprint.css"> 
  <link rel="stylesheet" type="text/css" href="http://revectores.com//static/css/blog.css"> 
  <link rel="stylesheet" type="text/css" href="http://revectores.com//static/css/code.css"> 
  
</head>
<body>

<p><a href="../"><< numerical_analysis</a></p>

<h1 id="numerical-integration">Numerical Integration</h1>
<p><span class="math display">\[
\newcommand{\d}{\text{d}}
\newcommand{\dx}{\d x}
\newcommand{\ddx}{\dfrac{\d}{\d x}}
\]</span></p>
<h3 id="basic-concepts">1. Basic Concepts</h3>
<p><span class="math display">\[
I(f) = \int_a^b f(x)\dx
\]</span></p>
<p><span class="math display">\[
I_n(f) = \sum_{i=0}^n \alpha_i f(x_i)
\]</span> where <span class="math inline">\(x_i\)</span> is <strong>integral point</strong>, and <span class="math inline">\(\alpha_i\)</span> is <strong>integral coffieient</strong>,</p>
<p>if <span class="math inline">\(I_n(f)\)</span> obeys <span class="math display">\[
E_n(x^k) = I(x^k) - 
\]</span></p>
<h3 id="numerical-integration-by-interpolation">2. Numerical Integration by Interpolation</h3>
<p><span class="math display">\[
\int_a^b f(x)\dx
\approx \int_a^b L_n(x)\dx
= \int_a^b \sum_{i=0}^nl_i(x)f(x_i)\dx
= \sum_{i=0}^n \left(\int_a^b l_i(x)\dx \right) f(x_i)
\]</span></p>
<p>Denotes <span class="math inline">\(\alpha_i = \displaystyle \int_a^b l_i(x)\dx\)</span> <span class="math display">\[
I_n(f) = \int_a^b L_n(x)\dx = \sum_{i=0}^n \alpha_i f(x_i)
\]</span></p>
<blockquote>
<p>Example. Construct the numerical integration formula <span class="math inline">\(I_2(f)\)</span> for <span class="math inline">\(\displaystyle\int_0^2 f(x)\dx\)</span> by points <span class="math inline">\(x_0=0, x_1=0.5, x_2=2\)</span>. <span class="math display">\[
I_2(f)
= \int_0^2 L_2(x)\dx
= \int_0^2 (l_0(x)f(x_0) + l_1(x)f(x_1) + l_2f(x_2))\dx
\]</span></p>
</blockquote>
<p><span class="math display">\[
\int_0^{3h} f(x)\dx = \frac{3}{8}h[f(0)+3f(h)+3f(2h)+f(3h)]
\]</span></p>
<h3 id="newton-cotes-integration">3. Newton-Cote’s Integration</h3>
<p>Devide the integration interval <span class="math inline">\([a, b]\)</span> into <span class="math inline">\(n\)</span> equal intervals. Denote <span class="math inline">\(h=\dfrac{b-a}{n}\)</span>.</p>
<h5 id="trapezoid-integration"># Trapezoid Integration</h5>
<p>Linear interpolation: <span class="math display">\[
\int_a^b f(x)\dx
\approx \int_a^b L_1(x)\dx
\]</span> One <span class="math display">\[
T(f) = \frac{b-a}{2}(f(a)+f(b))
= (b-a)\left( \frac{f(a)}{2} + \frac{f(b)}{2} \right)
\]</span></p>
<p>Truncatation error: <span class="math display">\[
f(x) = L_1(x) + \frac{f&#39;&#39;(\xi)}{2!}(x-a)(x-b), a\le\xi\le b
\]</span></p>
<h6 id="simpson-integration"># SimpSon Integration</h6>
<p>Quadratic interpolation: <span class="math display">\[
\int_a^b f(x)\dx
\approx \int_a^b L_2(x)\dx
\]</span></p>
<p><span class="math display">\[
S(f) = \frac{b-a}{6}\left(f(a) + 4f\left(\frac{a+b}{2}\right) + f(b)\right)
\]</span></p>
<h5 id="general-newton-cotes-integration"># General Newton-Cote’s Integration</h5>
<p><span class="math display">\[
\alpha_i = \int_a^b l_i(x)\dx =
\]</span></p>
<p>Let <span class="math inline">\(x=a+th, ~x_i = a + ih\)</span>, we have <span class="math display">\[
\alpha_i = \int_0^n \frac{}{i!(n-i)!(-1)^{n-i}}h\d t
\]</span></p>
<p><span class="math display">\[
c_i^{(n)} = (-1)^{n-i}\frac{1}{i!(n-i)n}\int_0^n t(t-1)\cdots(t-i+1)(t-i-1)\cdots(t-n)\d t
\]</span> Notice that <span class="math inline">\(c_i^{(n)}\)</span> only relavent to <span class="math inline">\(n\)</span> but the <span class="math inline">\(x_i\)</span>, we call it the Newton-Cote’s coefficient.</p>
<table>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/2</td>
<td>1/2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
<td>4/6</td>
<td>1/6</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/8</td>
<td>3/8</td>
<td>3/8</td>
<td>1/8</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td>7/90</td>
<td>16/45</td>
<td>2/15</td>
<td>16/45</td>
<td>7/90</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>5</td>
<td>19/288</td>
<td>25/96</td>
<td>25/144</td>
<td>25/144</td>
<td>25/96</td>
<td>19/288</td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td>41/840</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>For <span class="math inline">\(n\le7\)</span>, $$</p>
<h3 id="composite-integration">4. Composite Integration</h3>
<h5 id="composite-trapezoid-integration"># Composite Trapezoid Integration</h5>
<p><span class="math display">\[
h = \frac{b-a}{n}
\]</span></p>
<p><span class="math display">\[
x_i = a + ih, ~ i = 0,1,\ldots, n
\]</span></p>
<p><span class="math display">\[
\int_{x_i}^{x_{i+1}}f(x)\dx = \frac{h}{2}(f(x_i) + f(x_{i+1})) - f&#39;&#39;(\xi_i)\frac{h^3}{12}
\]</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(x_0\)</span></th>
<th><span class="math inline">\(x_1\)</span></th>
<th><span class="math inline">\(x_2\)</span></th>
<th><span class="math inline">\(x_3\)</span></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(h\)</span></td>
<td>1/2</td>
<td>1/2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>1/2</td>
<td>1/2</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td>1/2</td>
<td>1/2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>1/2</td>
<td>1</td>
<td>1</td>
<td>1/2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
I(f) = \sum_{i=0}^{n-1}
\]</span></p>
<p><span class="math display">\[
T(h) = T_n(f) = h\left[ \frac{1}{2}f(a) + \sum_{i=1}^{n-1} f(x_i) + \frac{1}{2}f(b) \right]
\]</span></p>
<p><span class="math display">\[
E_n(f) = -\frac{h^3}{12}\sum_{i=0}^{n-1}f&#39;&#39;(\xi_i) 
\]</span></p>
<blockquote>
<p><strong>Proof</strong>. <span class="math display">\[
E_n(f) = I(f) - T_n(f) =
\]</span> Denote <span class="math display">\[
M_2 = \max_{a\le x\le b} |f&#39;&#39;(x)|
\]</span> then we have <span class="math display">\[
|E_n(f)| \le \frac{(b-a)^3}{12n^2}(b-a)M_2 = O\left(\frac{1}{n^2}\right)
\]</span> If <span class="math inline">\(N_2\)</span> is known, for any error control <span class="math inline">\(\varepsilon &gt; 0\)</span>, we have <span class="math display">\[
|E_n(f)| = &lt; \varepsilon
\]</span></p>
</blockquote>
<h5 id="composite-simpson-integration"># Composite SimpSon Integration</h5>
<p><span class="math display">\[
S_n(f) = \frac{h}{3}\left[ f(a) + 4\sum_{i=0}^{m-1}f(x_{2i+1}) + 2\sum_{i=1}^{n-1}f(x_{2i}) + f(b) \right]
\]</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">\(x_0\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_3\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_4\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_5\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_6\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_7\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_8\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(h/6\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(h/6\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
-\frac{(2h)^5}{2880}f^{(4)}(\xi_i), ~ x_{2i}\le\zeta_i\le x_{2i+2}
\]</span></p>
<blockquote>
<p>Example. Compute <span class="math inline">\(\displaystyle \int_0^1 \e^x\dx\)</span> to 5 decimal percision, how many points should be computed?</p>
</blockquote>
<blockquote>
<p>Compute <span class="math inline">\(\displaystyle \int_0^{1.2}\sin x^2\dx\)</span> based on Newton-Cote’s formula, composite trapezoid integration, and composite Simpson integration.</p>
</blockquote>
<h5 id="automatic-precision-control"># Automatic Precision Control</h5>
<p>Compute integral using Romberg algorithm:</p>
<h5 id="romberg-integration"># Romberg Integration</h5>
<p><span class="math display">\[
\begin{align}
&amp; I(f) - T_n(f) = -\frac{1}{12}f&#39;&#39;(\xi)h^2 = ch^2 \\
&amp; I(f) - T_{2n}(f) = -\frac{1}{12}f&#39;&#39;(\xi)\left(\frac{h}{2}\right)^2 = ch^2
\end{align}
\]</span></p>
<p><span class="math display">\[
R_{k,j} = R_{k, j-1} + \frac{R_{k, j-1}-R_{k-1,j-1}}{4^{j-1}-1}, ~~~~ k = 2, 3, \ldots
\]</span> Compute until the <span class="math inline">\(|R_{k,k}-R_{k-1,k-1}|\)</span> is less than given precision.</p>
<h3 id="multiple-integral">6. Multiple Integral</h3>
<p>Compute double integral <span class="math inline">\(\displaystyle \int_0^1\int_0^2 \sin(x^2+y)\d y\dx\)</span>.</p>


</body>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</html>